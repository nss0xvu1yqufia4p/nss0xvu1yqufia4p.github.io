<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>FEAL</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style type="text/css">@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
width: 728px;
max-width: 99%;
box-sizing: border-box;
padding: 30px 30px 8rem 30px;
margin-left: auto;
margin-right: auto;
}
body a {
background-color: transparent;
}
body a:active,
body a:hover {
outline: 0;
}
body strong {
font-weight: bold;
}
body h1 {
font-size: 2em;
margin: 0.67em 0;
}
body img {
border: 0;
}
body hr {
box-sizing: content-box;
height: 0;
}
body pre {
overflow: auto;
}
body code,
body kbd,
body pre {
font-family: monospace, monospace;
font-size: 1em;
}
body input {
color: inherit;
font: inherit;
margin: 0;
}
body html input[disabled] {
cursor: default;
}
body input {
line-height: normal;
}
body input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
body table {
border-collapse: collapse;
border-spacing: 0;
}
body td,
body th {
padding: 0;
}
body * {
box-sizing: border-box;
}
body input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
body a {
color: #4078c0;
text-decoration: none;
}
body a:hover,
body a:active {
text-decoration: underline;
}
body hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
body hr:before {
display: table;
content: "";
}
body hr:after {
display: table;
clear: both;
content: "";
}
body h1,
body h2,
body h3,
body h4,
body h5,
body h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
body h1 {
font-size: 30px;
}
body h2 {
font-size: 21px;
}
body h3 {
font-size: 16px;
}
body h4 {
font-size: 14px;
}
body h5 {
font-size: 12px;
}
body h6 {
font-size: 11px;
}
body blockquote {
margin: 0;
}
body ul,
body ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
body ol ol,
body ul ol {
list-style-type: lower-roman;
}
body ul ul ol,
body ul ol ol,
body ol ul ol,
body ol ol ol {
list-style-type: lower-alpha;
}
body dd {
margin-left: 0;
}
body code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
body pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
body .select::-ms-expand {
opacity: 0;
}
body .octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
body .octicon-link:before {
content: '\f05c';
}
body:before {
display: table;
content: "";
}
body:after {
display: table;
clear: both;
content: "";
}
body>*:first-child {
margin-top: 0 !important;
}
body>*:last-child {
margin-bottom: 0 !important;
}
body a:not([href]) {
color: inherit;
text-decoration: none;
}
body .anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
body .anchor:focus {
outline: none;
}
body h1,
body h2,
body h3,
body h4,
body h5,
body h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
body h1 .octicon-link,
body h2 .octicon-link,
body h3 .octicon-link,
body h4 .octicon-link,
body h5 .octicon-link,
body h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
body h1:hover .anchor,
body h2:hover .anchor,
body h3:hover .anchor,
body h4:hover .anchor,
body h5:hover .anchor,
body h6:hover .anchor {
text-decoration: none;
}
body h1:hover .anchor .octicon-link,
body h2:hover .anchor .octicon-link,
body h3:hover .anchor .octicon-link,
body h4:hover .anchor .octicon-link,
body h5:hover .anchor .octicon-link,
body h6:hover .anchor .octicon-link {
visibility: visible;
}
body h1 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.2;
}
body h1 .anchor {
line-height: 1;
}
body h2 {
padding-bottom: 0.3em;
font-size: 1.5em;
line-height: 1.225;
}
body h2 .anchor {
line-height: 1;
}
body h3 {
font-size: 1.25em;
line-height: 1.43;
}
body h3 .anchor {
line-height: 1.2;
}
body h4 {
font-size: 1em;
}
body h4 .anchor {
line-height: 1.2;
}
body h5 {
font-size: 1em;
}
body h5 .anchor {
line-height: 1.1;
}
body h6 {
font-size: 1em;
color: #777;
}
body h6 .anchor {
line-height: 1.1;
}
body p,
body blockquote,
body ul,
body ol,
body dl,
body table,
body pre {
margin-top: 0;
margin-bottom: 16px;
}
body hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
body ul,
body ol {
padding-left: 2em;
}
body ul ul,
body ul ol,
body ol ol,
body ol ul {
margin-top: 0;
margin-bottom: 0;
}
body li>p {
margin-top: 16px;
}
body dl {
padding: 0;
}
body dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
body dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
body blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
body blockquote>:first-child {
margin-top: 0;
}
body blockquote>:last-child {
margin-bottom: 0;
}
body table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
body table th {
font-weight: bold;
}
body table th,
body table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
body table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
body table tr:nth-child(2n) {
background-color: #f8f8f8;
}
body img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
body code {
padding: 0;
padding-top: 0;
padding-bottom: 0;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
body code:before,
body code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
body pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
body .highlight {
margin-bottom: 16px;
}
body .highlight pre,
body pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.sourceCode {
background-color: #f7f7f7;
}
body .highlight pre {
margin-bottom: 0;
word-break: normal;
}
body pre {
word-wrap: normal;
}
body pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
body pre code:before,
body pre code:after {
content: normal;
}
body kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
body .pl-c {
color: #969896;
}
body .pl-c1,
body .pl-s .pl-v {
color: #0086b3;
}
body .pl-e,
body .pl-en {
color: #795da3;
}
body .pl-s .pl-s1,
body .pl-smi {
color: #333;
}
body .pl-ent {
color: #63a35c;
}
body .pl-k {
color: #a71d5d;
}
body .pl-pds,
body .pl-s,
body .pl-s .pl-pse .pl-s1,
body .pl-sr,
body .pl-sr .pl-cce,
body .pl-sr .pl-sra,
body .pl-sr .pl-sre {
color: #183691;
}
body .pl-v {
color: #ed6a43;
}
body .pl-id {
color: #b52a1d;
}
body .pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
body .pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
body .pl-ml {
color: #693a17;
}
body .pl-mh,
body .pl-mh .pl-en,
body .pl-ms {
color: #1d3e81;
font-weight: bold;
}
body .pl-mq {
color: #008080;
}
body .pl-mi {
color: #333;
font-style: italic;
}
body .pl-mb {
color: #333;
font-weight: bold;
}
body .pl-md {
background-color: #ffecec;
color: #bd2c00;
}
body .pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
body .pl-mdr {
color: #795da3;
font-weight: bold;
}
body .pl-mo {
color: #1d3e81;
}
body kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
body .task-list-item {
list-style-type: none;
}
body .task-list-item+.task-list-item {
margin-top: 3px;
}
body .task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
body :checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="differential-cryptanalysis-of-feal---implementation">Differential Cryptanalysis of FEAL - implementation</h1>
<p>Just a short C++ implementation of an attack on the FEAL-4 block cipher outlined here: <a href="http://theamazingking.com/crypto-feal.php" class="uri">http://theamazingking.com/crypto-feal.php</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">//This code requires c++11 compile with g++ -std=c++11</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">//Found A to be 0x006c1800</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="pp">#include </span><span class="im">&lt;stdint.h&gt;</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="pp">#include </span><span class="im">&lt;inttypes.h&gt;</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="pp">#include </span><span class="im">&lt;limits.h&gt;</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="pp">#include </span><span class="im">&lt;assert.h&gt;</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="pp">#include </span><span class="im">&lt;utility&gt;</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="pp">#include </span><span class="im">&lt;map&gt;</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="pp">#include </span><span class="im">&lt;numeric&gt;</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="pp">#include </span><span class="im">&lt;set&gt;</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="pp">#include </span><span class="im">&lt;functional&gt;</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">using</span> <span class="kw">namespace</span> std;</a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">//left rotation, adapted from </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">//stackoverflow.com/questions/776508/best-practices-for-circular-shift-rotate-operations-in-c</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="at">static</span> <span class="kw">inline</span> <span class="dt">uint8_t</span> rotl8_2 (<span class="dt">uint8_t</span> n) {</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">    <span class="at">const</span> <span class="dt">unsigned</span> <span class="dt">int</span> mask = (CHAR_BIT*<span class="kw">sizeof</span>(n) - <span class="dv">1</span>);  <span class="co">// assumes width is a power of 2.</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">    <span class="dt">unsigned</span> <span class="dt">int</span> c = <span class="dv">2</span> &amp; mask;</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">    <span class="cf">return</span> (n&lt;&lt;c) | (n&gt;&gt;( (-c)&amp;mask ));</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">}</a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">//used for getting the left or right parts of different sized blocks</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="dt">uint32_t</span> left(<span class="dt">uint64_t</span> input) {</a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    <span class="cf">return</span> (<span class="dt">uint32_t</span>)(input&gt;&gt;<span class="dv">32</span>);</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">}</a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="dt">uint32_t</span> right(<span class="dt">uint64_t</span> input) {</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">    <span class="cf">return</span> (<span class="dt">uint32_t</span>)input;</a>
<a class="sourceLine" id="cb1-34" data-line-number="34">}</a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="dt">uint16_t</span> left(<span class="dt">uint32_t</span> input) {</a>
<a class="sourceLine" id="cb1-36" data-line-number="36">    <span class="cf">return</span> (<span class="dt">uint16_t</span>)(input&gt;&gt;<span class="dv">16</span>);</a>
<a class="sourceLine" id="cb1-37" data-line-number="37">}</a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="dt">uint16_t</span> right(<span class="dt">uint32_t</span> input) {</a>
<a class="sourceLine" id="cb1-39" data-line-number="39">    <span class="cf">return</span> (<span class="dt">uint16_t</span>)input;</a>
<a class="sourceLine" id="cb1-40" data-line-number="40">}</a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="dt">uint8_t</span> left(<span class="dt">uint16_t</span> input) {</a>
<a class="sourceLine" id="cb1-42" data-line-number="42">    <span class="cf">return</span> (<span class="dt">uint8_t</span>)(input&gt;&gt;<span class="dv">8</span>);</a>
<a class="sourceLine" id="cb1-43" data-line-number="43">}</a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="dt">uint8_t</span> right(<span class="dt">uint16_t</span> input) {</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">    <span class="cf">return</span> (<span class="dt">uint8_t</span>)input;</a>
<a class="sourceLine" id="cb1-46" data-line-number="46">}</a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="co">//concatenates 2 blocks</span></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="dt">uint64_t</span> concat(<span class="dt">uint32_t</span> left, <span class="dt">uint32_t</span> right) {</a>
<a class="sourceLine" id="cb1-49" data-line-number="49">    <span class="cf">return</span> ((<span class="dt">uint64_t</span>)left&lt;&lt;<span class="dv">32</span>) | (<span class="dt">uint64_t</span>)right;</a>
<a class="sourceLine" id="cb1-50" data-line-number="50">}</a>
<a class="sourceLine" id="cb1-51" data-line-number="51"><span class="dt">uint32_t</span> concat(<span class="dt">uint16_t</span> left, <span class="dt">uint16_t</span> right) {</a>
<a class="sourceLine" id="cb1-52" data-line-number="52">    <span class="cf">return</span> ((<span class="dt">uint32_t</span>)left&lt;&lt;<span class="dv">16</span>) | (<span class="dt">uint64_t</span>)right;</a>
<a class="sourceLine" id="cb1-53" data-line-number="53">}</a>
<a class="sourceLine" id="cb1-54" data-line-number="54"><span class="dt">uint16_t</span> concat(<span class="dt">uint8_t</span> left, <span class="dt">uint8_t</span> right) {</a>
<a class="sourceLine" id="cb1-55" data-line-number="55">    <span class="cf">return</span> ((<span class="dt">uint16_t</span>)left&lt;&lt;<span class="dv">8</span>) | (<span class="dt">uint16_t</span>)right;</a>
<a class="sourceLine" id="cb1-56" data-line-number="56">}</a>
<a class="sourceLine" id="cb1-57" data-line-number="57"><span class="dt">uint16_t</span> mid16(<span class="dt">uint32_t</span> input) {</a>
<a class="sourceLine" id="cb1-58" data-line-number="58">    <span class="cf">return</span> concat(right(left(input)), left(right(input)));</a>
<a class="sourceLine" id="cb1-59" data-line-number="59">}</a>
<a class="sourceLine" id="cb1-60" data-line-number="60"><span class="co">//define the functions used in the cipher</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"><span class="dt">uint8_t</span> G_0(<span class="dt">uint8_t</span> a, <span class="dt">uint8_t</span> b) {</a>
<a class="sourceLine" id="cb1-62" data-line-number="62">    <span class="cf">return</span> rotl8_2(a+b); </a>
<a class="sourceLine" id="cb1-63" data-line-number="63">}</a>
<a class="sourceLine" id="cb1-64" data-line-number="64"><span class="dt">uint8_t</span> G_1(<span class="dt">uint8_t</span> a, <span class="dt">uint8_t</span> b) {</a>
<a class="sourceLine" id="cb1-65" data-line-number="65">    <span class="cf">return</span> rotl8_2(a+b<span class="dv">+1</span>); </a>
<a class="sourceLine" id="cb1-66" data-line-number="66">}</a>
<a class="sourceLine" id="cb1-67" data-line-number="67"><span class="dt">uint32_t</span> F(<span class="dt">uint32_t</span> x) {</a>
<a class="sourceLine" id="cb1-68" data-line-number="68">    <span class="dt">uint8_t</span> x_0 = left(left(x));</a>
<a class="sourceLine" id="cb1-69" data-line-number="69">    <span class="dt">uint8_t</span> x_1 = right(left(x));</a>
<a class="sourceLine" id="cb1-70" data-line-number="70">    <span class="dt">uint8_t</span> x_2 = left(right(x));</a>
<a class="sourceLine" id="cb1-71" data-line-number="71">    <span class="dt">uint8_t</span> x_3 = right(right(x));</a>
<a class="sourceLine" id="cb1-72" data-line-number="72">    <span class="dt">uint8_t</span> y_1 = G_1(x_0^x_1, x_2^x_3);</a>
<a class="sourceLine" id="cb1-73" data-line-number="73">    <span class="dt">uint8_t</span> y_0 = G_0(x_0, y_1);</a>
<a class="sourceLine" id="cb1-74" data-line-number="74">    <span class="dt">uint8_t</span> y_2 = G_0(y_1, x_2^x_3);</a>
<a class="sourceLine" id="cb1-75" data-line-number="75">    <span class="dt">uint8_t</span> y_3 = G_1(y_2, x_3);</a>
<a class="sourceLine" id="cb1-76" data-line-number="76">    <span class="cf">return</span> concat(concat(y_0, y_1), concat(y_2, y_3));</a>
<a class="sourceLine" id="cb1-77" data-line-number="77">}</a>
<a class="sourceLine" id="cb1-78" data-line-number="78"><span class="dt">uint32_t</span> M(<span class="dt">uint32_t</span> W) {</a>
<a class="sourceLine" id="cb1-79" data-line-number="79">    <span class="dt">uint8_t</span> zero = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-80" data-line-number="80">    <span class="dt">uint8_t</span> b_0 = left(left(W));</a>
<a class="sourceLine" id="cb1-81" data-line-number="81">    <span class="dt">uint8_t</span> b_1 = right(left(W));</a>
<a class="sourceLine" id="cb1-82" data-line-number="82">    <span class="dt">uint8_t</span> b_2 = left(right(W));</a>
<a class="sourceLine" id="cb1-83" data-line-number="83">    <span class="dt">uint8_t</span> b_3 = right(right(W));</a>
<a class="sourceLine" id="cb1-84" data-line-number="84">    <span class="cf">return</span> concat(concat(zero, b_0^b_1), concat(b_2^b_3, zero));</a>
<a class="sourceLine" id="cb1-85" data-line-number="85">}</a>
<a class="sourceLine" id="cb1-86" data-line-number="86"></a>
<a class="sourceLine" id="cb1-87" data-line-number="87"><span class="kw">typedef</span> pair&lt;<span class="dt">uint64_t</span>, <span class="dt">uint64_t</span>&gt; TextPair;</a>
<a class="sourceLine" id="cb1-88" data-line-number="88"></a>
<a class="sourceLine" id="cb1-89" data-line-number="89"><span class="dt">int</span> main() {</a>
<a class="sourceLine" id="cb1-90" data-line-number="90">    vector&lt;TextPair&gt; C; <span class="co">//Vector of ciphertext pairs</span></a>
<a class="sourceLine" id="cb1-91" data-line-number="91">    map&lt;<span class="dt">uint32_t</span>, <span class="dt">int</span>&gt; K; <span class="co">//Subkey 3 candidates</span></a>
<a class="sourceLine" id="cb1-92" data-line-number="92"></a>
<a class="sourceLine" id="cb1-93" data-line-number="93">    C.push_back(TextPair(<span class="bn">0xC5A28940BA4404D5</span>, <span class="bn">0x46CA82A3C1A4EEB1</span>));</a>
<a class="sourceLine" id="cb1-94" data-line-number="94">    C.push_back(TextPair(<span class="bn">0xAE2E85104CA3503A</span>, <span class="bn">0x305BAE5E6A5E9AF0</span>));</a>
<a class="sourceLine" id="cb1-95" data-line-number="95">    C.push_back(TextPair(<span class="bn">0x5ED24A0C6B88048F</span>, <span class="bn">0x39D3D508A401BB0B</span>));</a>
<a class="sourceLine" id="cb1-96" data-line-number="96">    C.push_back(TextPair(<span class="bn">0x2ABDDDE91DF1DE33</span>, <span class="bn">0x0EAC11075168F358</span>));</a>
<a class="sourceLine" id="cb1-97" data-line-number="97"></a>
<a class="sourceLine" id="cb1-98" data-line-number="98">    <span class="dt">uint32_t</span> diff_0 = <span class="bn">0x80800000</span>;</a>
<a class="sourceLine" id="cb1-99" data-line-number="99">    <span class="dt">uint32_t</span> diff_1 = <span class="bn">0x02000000</span>;</a>
<a class="sourceLine" id="cb1-100" data-line-number="100">    </a>
<a class="sourceLine" id="cb1-101" data-line-number="101">    <span class="cf">for</span> (<span class="kw">auto</span> &amp; c: C) {</a>
<a class="sourceLine" id="cb1-102" data-line-number="102">        printf(<span class="st">&quot;Starting Ciphertext pair 0x%&quot;</span> PRIx64 <span class="st">&quot;, 0x%&quot;</span> PRIx64  <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, c.first, c.second);</a>
<a class="sourceLine" id="cb1-103" data-line-number="103">        <span class="dt">uint32_t</span> L_0 = left(c.first);</a>
<a class="sourceLine" id="cb1-104" data-line-number="104">        <span class="dt">uint32_t</span> R_0 = right(c.first);</a>
<a class="sourceLine" id="cb1-105" data-line-number="105">        <span class="dt">uint32_t</span> Y_0 = L_0^R_0;</a>
<a class="sourceLine" id="cb1-106" data-line-number="106">        <span class="dt">uint32_t</span> L_1 = left(c.second);</a>
<a class="sourceLine" id="cb1-107" data-line-number="107">        <span class="dt">uint32_t</span> R_1 = right(c.second);</a>
<a class="sourceLine" id="cb1-108" data-line-number="108">        <span class="dt">uint32_t</span> Y_1 = L_1^R_1;</a>
<a class="sourceLine" id="cb1-109" data-line-number="109">        <span class="dt">uint32_t</span> L_p = L_0^L_1;</a>
<a class="sourceLine" id="cb1-110" data-line-number="110">        <span class="dt">uint32_t</span> Z_p = L_p^diff_1;</a>
<a class="sourceLine" id="cb1-111" data-line-number="111">        vector&lt;<span class="dt">uint16_t</span>&gt; A; <span class="co">//Primary algo candidates</span></a>
<a class="sourceLine" id="cb1-112" data-line-number="112">        <span class="cf">for</span> (<span class="dt">uint32_t</span> i=<span class="dv">0</span>; i&lt;(<span class="bn">0xFFFF</span><span class="dv">+1</span>); ++i) {</a>
<a class="sourceLine" id="cb1-113" data-line-number="113">            <span class="dt">uint16_t</span> j = i;</a>
<a class="sourceLine" id="cb1-114" data-line-number="114">            <span class="dt">uint8_t</span> zero = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-115" data-line-number="115">            <span class="dt">uint8_t</span> a_0 = left(j);</a>
<a class="sourceLine" id="cb1-116" data-line-number="116">            <span class="dt">uint8_t</span> a_1 = right(j);</a>
<a class="sourceLine" id="cb1-117" data-line-number="117">            <span class="dt">uint32_t</span> Q_0 = F(M(Y_0)^concat(concat(zero, a_0), concat(a_1, zero)));</a>
<a class="sourceLine" id="cb1-118" data-line-number="118">            <span class="dt">uint32_t</span> Q_1 = F(M(Y_1)^concat(concat(zero, a_0), concat(a_1, zero)));</a>
<a class="sourceLine" id="cb1-119" data-line-number="119">            <span class="cf">if</span> (mid16(Q_1^Q_0)==mid16(Z_p)) {</a>
<a class="sourceLine" id="cb1-120" data-line-number="120">                A.push_back(j);</a>
<a class="sourceLine" id="cb1-121" data-line-number="121">            }</a>
<a class="sourceLine" id="cb1-122" data-line-number="122">        }</a>
<a class="sourceLine" id="cb1-123" data-line-number="123">        printf(<span class="st">&quot;Found </span><span class="sc">%d</span><span class="st"> candidates for A=M(K3)</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dt">int</span>(A.size()));</a>
<a class="sourceLine" id="cb1-124" data-line-number="124">        <span class="dt">int</span> kcount = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-125" data-line-number="125">        <span class="cf">for</span> (<span class="kw">auto</span> &amp; a:A) {</a>
<a class="sourceLine" id="cb1-126" data-line-number="126">            <span class="dt">uint8_t</span> a_0 = left(a);</a>
<a class="sourceLine" id="cb1-127" data-line-number="127">            <span class="dt">uint8_t</span> a_1 = right(a);</a>
<a class="sourceLine" id="cb1-128" data-line-number="128">            <span class="cf">for</span> (<span class="dt">uint32_t</span> i=<span class="dv">0</span>; i&lt;(<span class="bn">0xFFFF</span><span class="dv">+1</span>); ++i) {</a>
<a class="sourceLine" id="cb1-129" data-line-number="129">                <span class="dt">uint16_t</span> j = i;</a>
<a class="sourceLine" id="cb1-130" data-line-number="130">                <span class="dt">uint8_t</span> c_0 = left(j);</a>
<a class="sourceLine" id="cb1-131" data-line-number="131">                <span class="dt">uint8_t</span> c_1 = right(j);</a>
<a class="sourceLine" id="cb1-132" data-line-number="132">                <span class="dt">uint32_t</span> D = concat(concat(c_0, a_0^c_0), concat(a_1^c_1, c_1));</a>
<a class="sourceLine" id="cb1-133" data-line-number="133">                <span class="dt">uint32_t</span> Z_0_hat = F(Y_0^D);</a>
<a class="sourceLine" id="cb1-134" data-line-number="134">                <span class="dt">uint32_t</span> Z_1_hat = F(Y_1^D);</a>
<a class="sourceLine" id="cb1-135" data-line-number="135">                <span class="cf">if</span> ((Z_0_hat^Z_1_hat) == Z_p) {</a>
<a class="sourceLine" id="cb1-136" data-line-number="136">                    K[D]++;</a>
<a class="sourceLine" id="cb1-137" data-line-number="137">                    kcount++;</a>
<a class="sourceLine" id="cb1-138" data-line-number="138">                }</a>
<a class="sourceLine" id="cb1-139" data-line-number="139">            }</a>
<a class="sourceLine" id="cb1-140" data-line-number="140">        }   </a>
<a class="sourceLine" id="cb1-141" data-line-number="141">        printf(<span class="st">&quot;Found </span><span class="sc">%d</span><span class="st"> Candidate Keys for this ciphertext pair</span><span class="sc">\n\n</span><span class="st">&quot;</span>, kcount);</a>
<a class="sourceLine" id="cb1-142" data-line-number="142">    }</a>
<a class="sourceLine" id="cb1-143" data-line-number="143">    printf(<span class="st">&quot;Found </span><span class="sc">%d</span><span class="st"> candidate keys in total</span><span class="sc">\n\n</span><span class="st">&quot;</span>, <span class="dt">int</span>(K.size()));</a>
<a class="sourceLine" id="cb1-144" data-line-number="144">    </a>
<a class="sourceLine" id="cb1-145" data-line-number="145">    <span class="co">//The rest of the code is just manipulating stl containers to output stats</span></a>
<a class="sourceLine" id="cb1-146" data-line-number="146">    vector&lt;<span class="dt">int</span>&gt; counts;</a>
<a class="sourceLine" id="cb1-147" data-line-number="147">    <span class="bu">std::</span>transform(K.begin(), K.end(), <span class="bu">std::</span>back_inserter(counts),</a>
<a class="sourceLine" id="cb1-148" data-line-number="148">        [](<span class="bu">std::</span>pair&lt;<span class="at">const</span> <span class="dt">uint32_t</span>, <span class="dt">int</span>&gt;&amp;p){<span class="cf">return</span> p.second;});</a>
<a class="sourceLine" id="cb1-149" data-line-number="149">    sort(counts.begin(), counts.end());</a>
<a class="sourceLine" id="cb1-150" data-line-number="150">    counts.erase(unique(counts.begin(), counts.end()), counts.end());</a>
<a class="sourceLine" id="cb1-151" data-line-number="151">    map&lt;<span class="dt">int</span>, <span class="dt">int</span>&gt; countmap;</a>
<a class="sourceLine" id="cb1-152" data-line-number="152">    <span class="cf">for</span> (<span class="kw">auto</span> &amp; count:counts) {</a>
<a class="sourceLine" id="cb1-153" data-line-number="153">        vector&lt;<span class="dt">int</span>&gt; temp;</a>
<a class="sourceLine" id="cb1-154" data-line-number="154">        <span class="bu">std::</span>transform(K.begin(), K.end(), <span class="bu">std::</span>back_inserter(temp), </a>
<a class="sourceLine" id="cb1-155" data-line-number="155">            [count](<span class="bu">std::</span>pair&lt;<span class="at">const</span> <span class="dt">uint32_t</span>, <span class="dt">int</span>&gt;&amp;p){<span class="cf">return</span> (p.second==count)?<span class="dv">1</span>:<span class="dv">0</span>;});</a>
<a class="sourceLine" id="cb1-156" data-line-number="156">        countmap[count]= <span class="bu">std::</span>accumulate(temp.begin(), temp.end(), <span class="dv">0</span>);</a>
<a class="sourceLine" id="cb1-157" data-line-number="157">    }</a>
<a class="sourceLine" id="cb1-158" data-line-number="158">    <span class="cf">for</span> (<span class="kw">auto</span> &amp; e:countmap) {</a>
<a class="sourceLine" id="cb1-159" data-line-number="159">        cout &lt;&lt; <span class="st">&quot;There are &quot;</span> &lt;&lt; e.second &lt;&lt; <span class="st">&quot; Candidate keys with a score of &quot;</span> &lt;&lt; e.first &lt;&lt;endl;</a>
<a class="sourceLine" id="cb1-160" data-line-number="160">    }</a>
<a class="sourceLine" id="cb1-161" data-line-number="161">    vector&lt;<span class="dt">uint32_t</span>&gt; high_score_keys;</a>
<a class="sourceLine" id="cb1-162" data-line-number="162">    cout &lt;&lt; <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Highest Score is: &quot;</span> &lt;&lt; counts.back() &lt;&lt; endl;</a>
<a class="sourceLine" id="cb1-163" data-line-number="163">    cout &lt;&lt; <span class="st">&quot;High Scoreing Candidate Keys are:</span><span class="sc">\n</span><span class="st">&quot;</span>;</a>
<a class="sourceLine" id="cb1-164" data-line-number="164">    set&lt;<span class="dt">uint32_t</span>&gt; A_vals;</a>
<a class="sourceLine" id="cb1-165" data-line-number="165">    <span class="cf">for</span> (<span class="kw">auto</span> &amp; e:K) {</a>
<a class="sourceLine" id="cb1-166" data-line-number="166">        <span class="cf">if</span> (e.second==counts.back()) {</a>
<a class="sourceLine" id="cb1-167" data-line-number="167">            A_vals.insert(M(e.first));</a>
<a class="sourceLine" id="cb1-168" data-line-number="168">            printf(<span class="st">&quot;0x%&quot;</span> PRIx32 <span class="st">&quot; Corresponding M(K3) is 0x%&quot;</span> PRIx32 <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, e.first, M(e.first));</a>
<a class="sourceLine" id="cb1-169" data-line-number="169">        }</a>
<a class="sourceLine" id="cb1-170" data-line-number="170">    }</a>
<a class="sourceLine" id="cb1-171" data-line-number="171">    assert(A_vals.size()==<span class="dv">1</span>);</a>
<a class="sourceLine" id="cb1-172" data-line-number="172">    printf(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Correct Value for A=M(k3) is: 0x%&quot;</span> PRIx32 <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, *A_vals.begin());     </a>
<a class="sourceLine" id="cb1-173" data-line-number="173">}</a></code></pre></div>
</body>
</html>
